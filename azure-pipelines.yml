trigger:
  branches:
    include:
      - main

pool:
  name: 'Default'

variables:
  mavenPOMFile: 'pom.xml'

steps:
  - task: Maven@3
    displayName: 'Maven package'
    inputs:
      mavenPomFile: '$(mavenPOMFile)'
      mavenOptions: '-Xmx3072m'  # Optional: Increase Maven memory allocation if needed
      goals: 'clean package'  # Specify Maven goals (e.g., clean and package)

  - task: CopyFiles@2
    displayName: 'Copy Files to Artifact Staging Directory'
    inputs:
      SourceFolder: '$(System.DefaultWorkingDirectory)/target'
      Contents: '**/*.jar'
      TargetFolder: '$(Build.ArtifactStagingDirectory)'
    condition: succeededOrFailed()

  - task: PublishBuildArtifacts@1
    displayName: 'Publish Artifact: drop'
    inputs:
      PathtoPublish: '$(Build.ArtifactStagingDirectory)'
    condition: succeededOrFailed()
